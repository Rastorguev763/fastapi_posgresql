# Описание проекта

Этот проект представляет собой веб-сервис на основе FastAPI, который выполняет следующие функции:

- Принимает POST REST-запросы с содержимым вида `{"questions_num": integer}`.
- Запрашивает указанное количество случайных англоязычных вопросов для викторины с публичного API.
- Сохраняет полученные вопросы в базе данных, вместе с информацией о вопросе и дате создания.
- Отвечает на запросы предыдущими сохраненными вопросами.

## Используемые модули

В этом проекте используются следующие модули:

- **FastAPI**: Фреймворк для создания веб-сервисов на Python. Он обеспечивает простоту и быстроту разработки, автоматическую документацию API и поддержку асинхронности. Более подробную информацию можно найти на [официальном сайте FastAPI](https://fastapi.tiangolo.com/).
- **requests**: Модуль для отправки HTTP-запросов. В данном проекте он используется для взаимодействия с публичным API для получения случайных вопросов. Дополнительную информацию можно найти в [документации requests](https://docs.python-requests.org/).
- **SQLAlchemy**: Библиотека для работы с базами данных с помощью SQL. Она обеспечивает удобный и абстрактный интерфейс для взаимодействия с различными СУБД. Более подробную информацию можно найти на [официальном сайте SQLAlchemy](https://www.sqlalchemy.org/).
- **Pydantic**: Библиотека для валидации данных и сериализации. В этом проекте она используется для валидации входных запросов и моделей данных. Подробная информация доступна на [официальном сайте Pydantic](https://pydantic-docs.helpmanual.io/).
- **uvicorn**: ASGI-сервер для запуска FastAPI приложений. Он обеспечивает быстрое и эффективное выполнение веб-сервиса. Подробную информацию можно найти на [официальном сайте Uvicorn](https://www.uvicorn.org/).

## Установка зависимостей

Для установки зависимостей, необходимых для запуска этого проекта, выполните следующие шаги:

1. Убедитесь, что у вас установлен Python версии 3.7 или выше.

2. Создайте и активируйте виртуальное окружение (необязательно, но рекомендуется).

3. Убедитесь, что у вас установлен инструмент управления пакетами `pip`.

4. Установите зависимости, запустив следующую команду:

```bash
pip install -r requirements.txt
```

## Подключения базы данных

В этом проекте используются предусмотрено использование базы данных SQL:

- **PostgreSQL**: [инструкция](<https://github.com/Rastorguev763/fastapi_posgresql/blob/c75ab9e2fe255248a500a1db6b44a8520375dd97/postgresql/readme.md>)  по развертки базы

или

- **Sqlite**: используйте этот код

```python
# создание sqlite 
engine = create_engine('sqlite:///questions.sqlite')
Base.metadata.create_all(bind=engine)
Session = sessionmaker(bind=engine)
```

## Запуск веб-сервера uvicorn

Запустите веб-сервер uvicorn с помощью команды:

```bash
uvicorn main:app --reload
```

- `main:app` указывает, что файл main.py содержит приложение FastAPI и его экземпляр называется app.

- Флаг `--reload` позволяет автоматически перезапускать сервер при изменениях в коде (полезно во время разработки).

После запуска uvicorn, FastAPI веб-сервис будет доступен <http://127.0.0.1:8000/>

## Создание и запуск в Docker

- Установите Docker по [инструкции](<https://github.com/Rastorguev763/fastapi_posgresql/blob/c75ab9e2fe255248a500a1db6b44a8520375dd97/postgresql/readme.md>)

- Клонируйте репозиторий
- Откройте терминал в текущей папке
- Запустите команду

```bash
docker-compose up -d
```

- ## Вариант с web страницей (по умолчанию запускается в контейнере) main_web.py

После сборки и установки всех зависимостей, web страница будет доступна по адресу <http://127.0.0.1:8000/>

- ## Вариант без web страницы main.py

После сборки и установки всех зависимостей, для отправки запроса используйте команду

```GET
<http://127.0.0.1:8000/questions?num_question=>`<КОЛИЧЕСТВО ВОПРОСОВ КОТОРЫЕ НУЖНО ПОЛУЧИТЬ>
```

## Обратите внимание, проект настроен для запуска в Docker с помощью Docker Compose

- Подключение вэб приложения к базе PostgreSQL с локальной машины

```python
# запуск с локальной машины
db_url = f'postgresql://{db_user}:{db_password}@{db_host}:{db_port}/{db_name}'
```

- Подключение вэб приложения запущенного в контейнере к базе PostgreSQL

```python
# запуск с контейнера
db_url = f'postgresql://{db_user}:{db_password}@{container_name}/{db_name}'
```
